<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>TVHS Video Library</title>

  <link rel="icon" type="image/png" href="favicon.ico" />

  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />

  <!-- Your custom CSS files -->
  <link rel="stylesheet" href="css/reset.css" />
  <link rel="stylesheet" href="css/style.css" />


  <style>
    /* General layout */
main {
  max-width: 90%;
  margin: auto;
  padding: 2rem 1rem;
}

/* Overlay & popup */
#overlay {
  position: fixed;
  top: 0; left: 0;
  width: 100vw; height: 100vh;
  background-color: rgba(0, 0, 0, 0.7);
  z-index: 999;
  display: none;
}

#videoPopup {
  position: fixed;
  top: 50%; left: 50%;
  transform: translate(-50%, -50%);
  width: 640px;
  max-width: 90%;
  background: #000;
  padding: 15px;
  z-index: 1000;
  display: none;
  border-radius: 8px;
  box-shadow: 0 0 15px rgba(0, 0, 0, 0.5);
}

#videoPopup video {
  width: 100%;
  height: auto;
  display: block;
  margin-bottom: 10px;
}

/* Slider container - horizontal scrolling */
.slider-container {
  overflow-x: auto;    /* horizontal scroll */
  overflow-y: hidden;  /* hide vertical scroll */
  white-space: nowrap; /* keep cards inline */
  scroll-behavior: smooth;
  padding: 0 1rem;
  -webkit-overflow-scrolling: touch; /* smooth scrolling on iOS */
}

/* Cards inline and horizontal */
.movie-card {
  display: inline-block;   /* horizontal line up */
  vertical-align: top;
  width: 220px;
  margin-right: 1rem;
  cursor: pointer;
}

.movie-card img {
  width: 100%;
  display: block;
  border-radius: 10px 10px 0 0;
}

.movie-title {
  padding: 0.5rem;
  font-size: 0.95rem;
  font-weight: 500;
  text-align: center;
  color: #f1f1f1;
}

/* Arrows for navigation */
.arrow-btn {
  position: absolute;
  top: 50%;
  transform: translateY(-50%);
  background: none;
  border: none;
  color: white;
  font-size: 3.2rem;
  z-index: 10;
  cursor: pointer;
  padding: 0;
  user-select: none;
}

.arrow-left {
  left: -3rem;
}

.arrow-right {
  right: 0rem;
}

.arrow-btn:hover {
  color: #e50914;
}

/* Responsive adjustments */
@media (max-width: 992px) {
  .movie-card {
    width: calc(33.33vw - 1rem); /* ~3 cards on tablet */
  }
}

@media (max-width: 576px) {
  .movie-card {
    width: calc(50vw - 1rem); /* ~2 cards on mobile */
  }

  .movie-title {
    font-size: 0.85rem;
  }

  .arrow-btn {
    position: relative;
    font-size: 2.5rem;
  }
}

/* Video popup container styling */
.video-popup-container {
  position: fixed;
  top: 10%;
  left: 5%;
  width: 90%;
  max-width: 900px;
  background-color: rgba(0, 0, 0, 0.95);
  border-radius: 10px;
  z-index: 1001;
  padding: 15px;
  box-sizing: border-box;
}

.video-player {
  max-width: 100%;
  height: auto;
  border-radius: 8px;
}

.description-box {
  max-width: 500px;
  font-size: 1rem;
  line-height: 1.4;
  color: white;
}

/* Button styles inside popup */
.button-column button {
  margin-bottom: 0.5rem;
  font-size: 1.1rem;
  padding: 0.4rem 0.8rem;
}

/* Remove fullscreen button styles if still present */

  </style>
</head>
<body>
  <div class="navvy">
    <nav class="navbar navbar-expand-lg">
      <div class="container-fluid d-flex flex-column flex-lg-row justify-content-center gap-3" style="margin-top: -2%;">
        <!-- Guytje -->
        <div class="guytje order-0 mb-2 mb-lg-0">
          <a href="muziek.html">
            <img src="img/guytje2.png" class="img-fluid" alt="Cartoon placeholder" style="margin-top: 50%;" />
          </a>
        </div>

        <!-- Left nav (FILMS / VHS) -->
        <ul class="ulnav navbar-nav d-flex flex-column flex-lg-row order-2 order-lg-1 p-0">
          <li class="nav-item d-flex">
            <a class="nav-link px-2 py-1 btn-sm btn-red-active" href="TVHS.html">FILMS</a>
          </li>
          <li class="nav-item d-flex">
            <a class="nav-link px-2 py-1" href="muziek.html">VHS</a>
          </li>
        </ul>

        <!-- Logo -->
        <a class="navbar-brand order-1 order-lg-2 my-2 my-lg-0 px-2" href="index.html">
          <img class="logo" src="img/TVHSLL.png" alt="Logo" />
        </a>

        <!-- Right nav (MERCH / CONTACT) -->
        <ul class="ulnav navbar-nav d-flex flex-column flex-lg-row order-3 p-0">
          <li class="nav-item d-flex">
            <a class="nav-link px-2 py-1" href="merch.html">MERCH</a>
          </li>
          <li class="nav-item d-flex">
            <a class="nav-link px-2 py-1" id="dates" href="datescon.html">CONTACT</a>
          </li>
        </ul>
      </div>
    </nav>
  </div>

  <main>
    <div style="max-width: 100%; margin: auto; padding: 1rem;">
      <!-- Slider -->
      <div class="slider-container" id="movieSlider" aria-label="Video thumbnails slider"></div>
    </div>
  </main>

  <footer class="footers2">
    <div class="footer-logos">
      <img src="img/yuhd.png" alt="VHS logo" />
      <img class="footer-white" src="img/vhs.png" alt="VHS logo" />
    </div>
  </footer>

  <div id="overlay"></div>

  <div id="videoPopup" class="video-popup-container p-3" role="dialog" aria-modal="true" aria-label="Video player popup" tabindex="-1">
    <video id="videoElement" controls class="video-player" tabindex="0" playsinline>
      <source id="videoSource" src="" type="video/mp4" />
      Your browser does not support the video tag.
    </video>
    <div class="button-column">
      <button id="closeBtn" class="btn btn-sm btn-danger" aria-label="Close video">Sloate</button>
    </div>
  </div>

  <!-- Bootstrap Bundle JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

  <script>
    async function loadVideos() {
      try {
        // Fetch video data (adjust endpoint as needed)
        const res = await fetch('/.netlify/functions/get-google-drive-videos');
        if (!res.ok) throw new Error('Failed to fetch videos');

        const videos = await res.json();
        const slider = document.getElementById('movieSlider');
        const popup = document.getElementById('videoPopup');
        const videoElement = document.getElementById('videoElement');
        const videoSource = document.getElementById('videoSource');
        const overlay = document.getElementById('overlay');
        const closeBtn = document.getElementById('closeBtn');

        function openPopup(src) {
          videoSource.src = src;
          videoElement.load();
          popup.style.display = 'block';
          overlay.style.display = 'block';
          videoElement.focus();
          document.body.style.overflow = 'hidden'; // Prevent background scroll
        }

        function closePopup() {
          videoElement.pause();
          videoSource.src = '';
          videoElement.load();
          popup.style.display = 'none';
          overlay.style.display = 'none';
          document.body.style.overflow = '';
        }

        closeBtn.addEventListener('click', closePopup);
        overlay.addEventListener('click', closePopup);

        window.addEventListener('keydown', e => {
          if (e.key === 'Escape' && popup.style.display === 'block') {
            closePopup();
          }
        });

        videos.forEach(video => {
          const card = document.createElement('div');
          card.className = 'movie-card';
          card.tabIndex = 0;

          const img = document.createElement('img');
          img.src = `https://drive.google.com/thumbnail?id=${video.id}`;
          img.alt = video.title;

          const title = document.createElement('div');
          title.className = 'movie-title';
          title.textContent = video.title;

          card.appendChild(img);
          card.appendChild(title);

          card.addEventListener('click', () => {
            // Assuming mp4 URL or preview link, adapt if needed
            openPopup(`https://drive.google.com/uc?export=download&id=${video.id}`);
          });
          card.addEventListener('keydown', e => {
            if (e.key === 'Enter' || e.key === ' ') {
              e.preventDefault();
              openPopup(`https://drive.google.com/uc?export=download&id=${video.id}`);
            }
          });

          slider.appendChild(card);
        });
      } catch (err) {
        console.error('Error loading videos:', err);
      }
    }

    loadVideos();
  </script>
</body>
</html>
