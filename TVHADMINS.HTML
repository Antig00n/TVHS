<!DOCTYPE html>
<html lang="en"> 
<head>
  <link rel="icon" type="image/png" href="favicon.ico">
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale =1" />
  <title>TVHS</title>

<link rel="stylesheet" href="css/reset.css">


 
  <link
    href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
    rel="stylesheet"/>
      <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
           <link rel="stylesheet" href="css/moviecards.css">
</head>
<body>
  <style> </style>
 <!-- NAVBAR -->
   <div class="navvy">
<nav class="navbar navbar-expand-lg ">
  <div class="container-fluid d-flex flex-column flex-lg-row align-items-center justify-content-center gap-3">

    <!-- Guytje -->
    <div class="guytje order-0 mb-2 mb-lg-0 order-lg-0" style="width: 5%;">
      <img src="img/guytje2.png" class="img-fluid" alt="Cartoon placeholder" />
    </div>

    <!-- Left nav (SHOWS) -->
    <ul class="navbar-nav d-flex flex-column flex-lg-row align-items-center order-2 order-lg-1 p-0 m-0">
      <li class="nav-item d-flex align-items-center">
        <a class="nav-link px-2 py-1 btn-sm btn-red-active" href="TVHS.html">CLIPS</a>
      </li>
             <li class="nav-item d-flex align-items-center">
        <a class="nav-link px-2 py-1" href="muziek.html">MUSIC</a>
      </li>
    </ul>

    <!-- Logo -->
     
    <a class="navbar-brand order-1 order-lg-2 my-2 my-lg-0 px-2" href="index.html">
      <img class="logo" src="img/TVHSLL.png" alt="Logo">
    </a>

    <!-- Right nav (MUSIC and DATES) -->
    <ul class="navbar-nav d-flex flex-column flex-lg-row align-items-center order-3 p-0 m-0">
      
      
            <li class="nav-item d-flex align-items-center">
        <a class="nav-link px-2 py-1" href="merch.html">MERCH</a>
      </li>

      
       <li class="nav-item d-flex align-items-center">
        <a class="nav-link px-2 py-1 " id="dates" href="datescon.html">DATES & CONTACT</a>
      </li>
      
    </ul>

  </div>
</nav>
</div>
<main>
  
<form method="POST" action="/.netlify/functions/submit-show">
  <label>
    Date:
    <input type="date" name="showdate" required />
  </label>
  <label>
    Place:
    <input type="text" name="showplace" required />
  </label>
  <label>
    Person:
    <input type="text" name="showperson" required />
  </label>
  <label>
    Site:
    <input type="url" name="showsite" required />
  </label>
  <label>
    Price:
    <input type="number" name="showprice" step="0.01" required />
  </label>
  <button type="submit">Submit Show</button>
</form>

</main>

  <footer class="footers2">
    <div class="footer-logos">
      <img src="img/yuhd.png" alt="VHS logo" />
      <img class="footer-white" src="img/vhs.png" alt="VHS logo" />
    </div>
  </footer>
  

  

<script>

const { Client } = require("pg");
const querystring = require("querystring");

exports.handler = async (event) => {
  if (event.httpMethod !== "POST") {
    return {
      statusCode: 405,
      body: "Method Not Allowed",
    };
  }

  const data = querystring.parse(event.body);

  const client = new Client({
    connectionString: process.env.DATABASE_URL,
  });

  try {
    await client.connect();

    await client.query(
      `INSERT INTO shows (showdate, showplace, showperson, showsite, showprice)
       VALUES ($1, $2, $3, $4, $5)`,
      [
        data.showdate,
        data.showplace,
        data.showperson,
        data.showsite,
        parseFloat(data.showprice),
      ]
    );

    await client.end();

    return {
      statusCode: 200,
      headers: { "Content-Type": "text/html" },
      body: `
        <!DOCTYPE html>
        <html>
          <head>
            <title>Show Submitted</title>
            <style>
              body {
                font-family: system-ui, sans-serif;
                background: #f0f0f0;
                padding: 2rem;
                text-align: center;
              }
              .box {
                background: white;
                display: inline-block;
                padding: 2rem;
                border-radius: 8px;
                box-shadow: 0 0 10px rgba(0,0,0,0.1);
              }
              a {
                display: inline-block;
                margin-top: 1rem;
                color: #007acc;
                text-decoration: none;
              }
            </style>
          </head>
          <body>
            <div class="box">
              <h2>âœ… Show submitted successfully!</h2>
              <p>Thanks, ${data.showperson}, your performance on ${data.showdate} at ${data.showplace} has been saved.</p>
              <a href="/">Back to homepage</a>
            </div>
          </body>
        </html>
      `,
    };
  } catch (err) {
    console.error("DB error:", err);
    return {
      statusCode: 500,
      headers: { "Content-Type": "text/html" },
      body: `
        <h2>ðŸš¨ Whoops!</h2>
        <p>Something went wrong while saving your data.</p>
        <pre>${err.message}</pre>
      `,
    };
  }
};

</script>


</body>
</html>



