<!DOCTYPE html>
<html lang="en"> 
<head>
 <link rel="icon" type="image/png" href="favicon.ico">
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale =1" />
  <title>TVHS</title>

<link rel="stylesheet" href="css/reset.css">
  <link
    href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
    rel="stylesheet"/>

    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/shows.css">
</head>
<body>
  <!-- NAVBAR -->
<div class="navvy">
  <nav class="navbar navbar-expand-lg">
    <div class="container-fluid d-flex flex-column flex-lg-row justify-content-center gap-3" style="margin-top: -2%;">

      <!-- Guytje -->
      <div class="guytje order-0 mb-2 mb-lg-0">
        <a href="muziek.html">
          <img src="img/guytje2.png" class="img-fluid" alt="Cartoon placeholder" style="margin-top: 50%;" />
        </a>
      </div>

      <!-- Left nav (FILMS / VHS) -->
      <ul class="ulnav navbar-nav d-flex flex-column flex-lg-row order-2 order-lg-1 p-0">
        <li class="nav-item d-flex">
          <a class="nav-link px-2 py-1" href="TVHS.html">FILMS</a>
        </li>
        <li class="nav-item d-flex">
          <a class="nav-link px-2 py-1" href="muziek.html">VHS</a>
        </li>
      </ul>

      <!-- Logo -->
      <a class="navbar-brand order-1 order-lg-2 my-2 my-lg-0 px-2" href="index.html">
        <img class="logo" src="img/TVHSLL.png" alt="Logo">
      </a>

      <!-- Right nav (MERCH / CONTACT) -->
      <ul class="ulnav navbar-nav d-flex flex-column flex-lg-row order-3 p-0">
        <li class="nav-item d-flex">
          <a class="nav-link px-2 py-1" href="merch.html">MERCH</a>
        </li>

      </ul>

    </div>
  </nav>
</div>




  <!-- MAIN CONTENT -->
  <main class="container py-5">

    <div id="loading-overlay" style="
  position: fixed;
  top:0; left:0; right:0; bottom:0;
  background: rgba(0,0,0,0.7);
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: 9999;
">
  <img src="your-loading.gif" alt="Loading..." style="width: 100px; height: 100px; position: absolute; margin-top: 1%; margin-left: 1%;"  />
</div>
    <div class="row align-items-start text-center">

      <!-- NOW ONLY $6.66 (smaller & off to side) -->
         <div id="upcoming-shows-container" class="col-lg-3 order-2 order-lg-1 mb-4">
    <h2 style="text-align: center; margin-bottom: 1rem; color: rgb(168, 0, 0);">OPKOMENDE LIVE SHOWS</h2>
    <div id="upcoming-shows"></div>
  </div>

      <!-- WEEKLY SPOTLIGHT (wider center) -->
       <div class="col-lg-6 order-1 order-lg-2 mb-4">
    <h2 style="color: rgb(168, 0, 0);">RECENTE CLIPS</h2>
    
<div id="weeklySpotlightCarousel" class="carousel slide" data-bs-ride="carousel" data-bs-interval="30000">
 
  <div class="carousel-inner" >
    <div class="carousel-item active">
     <div class="video-wrapper">
  <iframe id="video1" src="" frameborder="0" allowfullscreen></iframe>
</div>
    </div>
    <div class="carousel-item">
        <div class="video-wrapper">
  <iframe id="video2" src="" frameborder="0" allowfullscreen></iframe>
</div>
    </div>
    <div class="carousel-item">
       <div class="video-wrapper">
  <iframe id="video3" src="" frameborder="0" allowfullscreen></iframe>
</div>
    </div>
  </div>
  

  <!-- White Dots / Indicators -->
  <div class="carousel-indicators position-relative mt-3">
    <button type="button" data-bs-target="#weeklySpotlightCarousel" data-bs-slide-to="0" class="active" aria-current="true" aria-label="Video 1"></button>
    <button type="button" data-bs-target="#weeklySpotlightCarousel" data-bs-slide-to="1" aria-label="Video 2"></button>
    <button type="button" data-bs-target="#weeklySpotlightCarousel" data-bs-slide-to="2" aria-label="Video 3"></button>
  </div>
</div>
      </div>

      <!-- CARTOON CHARACTER (smaller & off to side) -->
     <div class="col-lg-3 order-3 mb-4">
                <h2 class="slanted">FREE EVENT 25TH JULI</h2>
          <br>
      <a href="TVHS.html" > <img
          src="img/poster1.png"
          class="img-fluid"
          alt="Cartoon placeholder"
          style="width: 80%; margin-top: 10%; "
        /></a> 
      </div>

    </div>
  </main>

 

  <!-- FOOTER -->
  <footer class="footers">
    <div class="footer-logos">
      <img src="img/yuhd.png" alt="VHS logo" />
      <img class="footer-white" src="img/vhs.png" alt="VHS logo" />
    </div>
  </footer>

  <!-- Bootstrap JS bundle (includes Popper) -->
  <script
    src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"
  ></script>

<script>
async function loadShows() {
  const container = document.getElementById('upcoming-shows');
  const loadingOverlay = document.getElementById('loading-overlay');

  // Show loading overlay
  loadingOverlay.style.display = 'flex';

  try {
    const res = await fetch('/.netlify/functions/get-shows');
    const shows = await res.json();

    if (!Array.isArray(shows)) {
      container.textContent = 'Failed to load shows.';
      return;
    }

    // Get today's date without time for accurate comparison
    const today = new Date();
    today.setHours(0, 0, 0, 0);

    // Filter shows to only include those on or after today
    const upcomingShows = shows.filter(show => {
      const showDate = new Date(show.showdate);
      showDate.setHours(0, 0, 0, 0);
      return showDate >= today;
    });

    if (upcomingShows.length === 0) {
      container.textContent = 'No upcoming shows.';
      return;
    }

    const list = document.createElement('ul');

    upcomingShows.forEach(show => {
      const li = document.createElement('li');

      let text = `${show.showperson} | ${new Date(show.showdate).toLocaleDateString()} | ${show.showplace}`;

      if (show.showprice) {
        text += ` | €${show.showprice}`;
      }
      if (show.showsite) {
        text += ` | ${show.showsite}`;
      }

      li.textContent = text;
      list.appendChild(li);
    });

    container.innerHTML = '';
    container.appendChild(list);

  } catch (e) {
    container.textContent = 'Error loading shows.';
    console.error(e);
  } finally {
    // Hide loading overlay when done
    loadingOverlay.style.display = 'none';
  }
}

loadShows();

</script>

 <script>
  const carousel = document.getElementById('weeklySpotlightCarousel');
  const videos = carousel.querySelectorAll('video');

  const apiKey = 'AIzaSyAPaaNiKvRRV6NCvhRBOrQIOZP-EWbvbwc';
  const channelId = 'UCk3DsMaC1_4pDnqGcl9brBg';

  const maxResults = 3;

  async function loadLatestVideos() {
    try {
      const playlistRes = await fetch(
        `https://www.googleapis.com/youtube/v3/channels?part=contentDetails&id=${channelId}&key=${apiKey}`
      );
      const playlistData = await playlistRes.json();
      console.log('Playlist response:', playlistData);

      if (!playlistData.items || playlistData.items.length === 0) {
        throw new Error("No playlist data found — check your channel ID and API key.");
      }

      const uploadsPlaylistId = playlistData.items[0].contentDetails.relatedPlaylists.uploads;

      const videosRes = await fetch(
        `https://www.googleapis.com/youtube/v3/playlistItems?part=snippet&playlistId=${uploadsPlaylistId}&maxResults=${maxResults}&key=${apiKey}`
      );
      const videosData = await videosRes.json();
      console.log('Videos:', videosData);

      videosData.items.forEach((item, index) => {
        const videoId = item.snippet.resourceId.videoId;
        const embedUrl = `https://www.youtube.com/embed/${videoId}?origin=${location.origin}`;
        const iframe = document.getElementById(`video${index + 1}`);
        if (iframe) iframe.src = embedUrl;
      });

    } catch (error) {
      console.error('Failed to load videos:', error);
    }
  }

  loadLatestVideos();


</script>





</body>
</html>