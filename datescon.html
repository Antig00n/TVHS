<!DOCTYPE html>
<html lang="en"> 
<head>
 <link rel="icon" type="image/png" href="favicon.ico">
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale =1" />
  <title>TVHS</title>

<link rel="stylesheet" href="css/reset.css">
  <link
    href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
    rel="stylesheet"/>

    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/shows.css">
</head>
<body>
  <!-- NAVBAR -->
   <div class="navvy">
<nav class="navbar navbar-expand-lg ">
  <div class="container-fluid d-flex flex-column flex-lg-row align-items-center justify-content-center gap-3">

    <!-- Guytje -->
    <div class="guytje order-0 mb-2 mb-lg-0 order-lg-0" style="width: 5%;">
      <img src="img/guytje2.png" class="img-fluid" alt="Cartoon placeholder" />
    </div>

    <!-- Left nav (SHOWS) -->
    <ul class="navbar-nav d-flex flex-column flex-lg-row align-items-center order-2 order-lg-1 p-0 m-0">
      <li class="nav-item d-flex align-items-center">
        <a class="nav-link px-2 py-1" href="TVHS.html">CLIPS</a>
      </li>
       <li class="nav-item d-flex align-items-center">
        <a class="nav-link px-2 py-1" href="muziek.html">MUSIC</a>
      </li>
    </ul>

    <!-- Logo -->
     
    <a class="navbar-brand order-1 order-lg-2 my-2 my-lg-0 px-2" href="index.html">
      <img class="logo" src="img/TVHSLL.png" alt="Logo">
    </a>

    <!-- Right nav (MUSIC and DATES) -->
    <ul class="navbar-nav d-flex flex-column flex-lg-row align-items-center order-3 p-0 m-0">
    <li class="nav-item d-flex align-items-center">
        <a class="nav-link px-2 py-1 "  href="merch.html">MERCH</a>
      </li>
      
      <li class="nav-item d-flex align-items-center">
        <a class="nav-link px-2 py-1  btn-sm btn-red-active " id="dates" href="datescon.html">DATES & CONTACT</a>
      </li>
  
    </ul>

  </div>
</nav>
</div>


<main  class="container py-5">
<div class="row align-items-center text-center">
<div id="loading-overlay" style="
  position: fixed;
  top:0; left:0; right:0; bottom:0;
  background: rgba(0,0,0,0.7);
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: 9999;
">
  <img src="your-loading.gif" alt="Loading..." style="width: 100px; height: 100px; position: absolute; margin-top: 1%; margin-left: 1%;"  />
</div>



<div class="col-md-2 col-sm-12 mb-4 mb-md-0 side-item" style="margin-top: -4%;">
        
        <a class="slantedlink" target="_blank" href="https://www.instagram.com/vhsstoring/"><h2 class="slanted">847</h2></a>

        <a class="slantedlink" target="_blank"  href="https://www.instagram.com/kleinecrack/"><h2 class="slanted">Kleine Crack</h2></a>
        <a class="slantedlink" target="_blank"  href="https://www.instagram.com/parsalicious/"><h2 class="slanted">Parsa</h2></a>
        <a class="slantedlink" target="_blank"  href="https://www.instagram.com/roivandeduizter/"><h2 class="slanted">ROI</h2></a>
        <a class="slantedlink" target="_blank"  href="https://www.instagram.com/kleinekova/"><h2 class="slanted">Kleine Kova</h2></a>
    
      </div>

<div id="upcoming-shows-container" style="height: 95%;">

  

  <h2 style="text-align: center; margin-bottom: 1rem;">Upcoming Shows</h2>
  <div id="upcoming-shows"></div>
</div>

   <div class="col-md-2 col-sm-12 side-item">
        <img
          src="img/poster1.png"
          class="slanted img-fluid"
          alt="Cartoon placeholder"
        />
      </div>


</div>
</main>


  <!-- FOOTER -->
  <footer class="footers">
    <div class="footer-logos">
      <img src="img/yuhd.png" alt="VHS logo" />
      <img class="footer-white" src="img/vhs.png" alt="VHS logo" />
    </div>
  </footer>

  <!-- Bootstrap JS bundle (includes Popper) -->
  <script
    src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"
  ></script>

<script>
async function loadShows() {
  const container = document.getElementById('upcoming-shows');
  const loadingOverlay = document.getElementById('loading-overlay');

  // Show loading overlay
  loadingOverlay.style.display = 'flex';

  try {
    const res = await fetch('/.netlify/functions/get-shows');
    const shows = await res.json();

    if (!Array.isArray(shows)) {
      container.textContent = 'Failed to load shows.';
      return;
    }

    // Get today's date without time for accurate comparison
    const today = new Date();
    today.setHours(0, 0, 0, 0);

    // Filter shows to only include those on or after today
    const upcomingShows = shows.filter(show => {
      const showDate = new Date(show.showdate);
      showDate.setHours(0, 0, 0, 0);
      return showDate >= today;
    });

    if (upcomingShows.length === 0) {
      container.textContent = 'No upcoming shows.';
      return;
    }

    const list = document.createElement('ul');

    upcomingShows.forEach(show => {
      const li = document.createElement('li');

      let text = `${show.showperson} | ${new Date(show.showdate).toLocaleDateString()} | ${show.showplace}`;

      if (show.showprice) {
        text += ` | â‚¬${show.showprice}`;
      }
      if (show.showsite) {
        text += ` | ${show.showsite}`;
      }

      li.textContent = text;
      list.appendChild(li);
    });

    container.innerHTML = '';
    container.appendChild(list);

  } catch (e) {
    container.textContent = 'Error loading shows.';
    console.error(e);
  } finally {
    // Hide loading overlay when done
    loadingOverlay.style.display = 'none';
  }
}

loadShows();

</script>
</body>
</html>